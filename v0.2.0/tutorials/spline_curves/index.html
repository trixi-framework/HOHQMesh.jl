<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spline curves · HOHQMesh.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://trixi-framework.github.io/HOHQMesh.jl/stable/tutorials/spline_curves/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">HOHQMesh.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Interactive mesh generation</span><ul><li><a class="tocitem" href="../../interactive_overview/">Overview</a></li><li><a class="tocitem" href="../../guided-tour/">Guided tour</a></li><li><a class="tocitem" href="../../interactive-api/">API</a></li><li><a class="tocitem" href="../../CheatSheet/">Commands Cheat Sheet</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../introduction/">Overview</a></li><li><a class="tocitem" href="../straight_outer_boundary/">Straight-sided outer boundary</a></li><li><a class="tocitem" href="../curved_outer_boundary/">Curved outer boundary</a></li><li class="is-active"><a class="tocitem" href>Spline curves</a><ul class="internal"><li><a class="tocitem" href="#Initialization"><span>Initialization</span></a></li><li><a class="tocitem" href="#Add-the-outer-boundary"><span>Add the outer boundary</span></a></li><li><a class="tocitem" href="#Add-a-background-grid"><span>Add a background grid</span></a></li><li><a class="tocitem" href="#Add-the-inner-boundaries"><span>Add the inner boundaries</span></a></li><li><a class="tocitem" href="#Generate-the-mesh"><span>Generate the mesh</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="../create_edit_curves/">Creating and editing curves</a></li></ul></li><li><span class="tocitem">Advanced topics &amp; developers</span><ul><li><a class="tocitem" href="../../development/">Development</a></li><li><a class="tocitem" href="../../github-git/">GitHub &amp; Git</a></li><li><a class="tocitem" href="../../testing/">Testing</a></li></ul></li><li><a class="tocitem" href="../../reference/">Reference</a></li><li><a class="tocitem" href="../../authors/">Authors</a></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><a class="tocitem" href="../../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Spline curves</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spline curves</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/trixi-framework/HOHQMesh.jl/blob/main/docs/src/tutorials/spline_curves.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Spline-curves"><a class="docs-heading-anchor" href="#Spline-curves">Spline curves</a><a id="Spline-curves-1"></a><a class="docs-heading-anchor-permalink" href="#Spline-curves" title="Permalink"></a></h1><p>The purpose of this tutorial is to demonstrate how to create an unstructured mesh on a domain with a curved outer boundary and three inner boundaries. Two of the inner curves are built from cubic splines. The third inner curve is a triangular shape built from a chain of three straight line &quot;curves&quot;. The outer boundary, inner boundaries, background grid and mesh will be visualized for quality inspection.</p><p>It provides details and clarification for the script <code>interactive_spline_curves.jl</code> from the <a href="https://github.com/trixi-framework/HOHQMesh.jl/tree/main/examples">examples</a> folder.</p><h3 id="Synopsis"><a class="docs-heading-anchor" href="#Synopsis">Synopsis</a><a id="Synopsis-1"></a><a class="docs-heading-anchor-permalink" href="#Synopsis" title="Permalink"></a></h3><p>This tutorial demonstrates how to:</p><ul><li>Create a circular outer boundary curve.</li><li>Add the background grid when an outer boundary curve is present.</li><li>Visualize an interactive mesh project.</li><li>Construct and add parametric spline curves.</li><li>Construct and add an inner boundary chain of straight line segments.</li></ul><h2 id="Initialization"><a class="docs-heading-anchor" href="#Initialization">Initialization</a><a id="Initialization-1"></a><a class="docs-heading-anchor-permalink" href="#Initialization" title="Permalink"></a></h2><p>From a Julia REPL we load the HOHQMesh package as well as <a href="https://github.com/JuliaPlots/GLMakie.jl/">GLMakie</a>, a backend of <a href="https://github.com/JuliaPlots/Makie.jl/">Makie.jl</a>, to visualize the curves, mesh, etc. from the interactive tool.</p><pre><code class="language-julia hljs">julia&gt; using GLMakie, HOHQMesh</code></pre><p>Now we are ready to interactively generate unstructured quadrilateral meshes!</p><p>We create a new project with the name <code>&quot;spline_curves&quot;</code> and assign <code>&quot;out&quot;</code> to be the folder where any output files from the mesh generation process will be saved. By default, the output files created by HOHQMesh will carry the same name as the project. For example, the resulting HOHQMesh control file from this tutorial will be named <code>spline_curves.control</code>. If the folder <code>out</code> does not exist, it will be created automatically in the current file path.</p><pre><code class="language-julia hljs">spline_project = newProject(&quot;spline_curves&quot;, &quot;out&quot;)</code></pre><h2 id="Add-the-outer-boundary"><a class="docs-heading-anchor" href="#Add-the-outer-boundary">Add the outer boundary</a><a id="Add-the-outer-boundary-1"></a><a class="docs-heading-anchor-permalink" href="#Add-the-outer-boundary" title="Permalink"></a></h2><p>The outer boundary curve for this tutorial is a circle of radius <span>$r=4$</span> centered at the point <span>$(0, -1)$</span>. We define this circular curve with the function <code>newCircularArcCurve</code> as follows</p><pre><code class="language-julia hljs">circ = newCircularArcCurve(&quot;outerCircle&quot;,    # curve name
                           [0.0, -1.0, 0.0], # circle center
                           4.0,              # circle radius
                           0.0,              # start angle
                           360.0,            # end angle
                           &quot;degrees&quot;)        # angle units</code></pre><p>We use <code>&quot;degrees&quot;</code> to set the angle bounds, but <code>&quot;radians&quot;</code> can also be used. The name of the curve stored in the dictionary <code>circ</code> is assigned to be <code>&quot;outerCircle&quot;</code>. This curve name is also the label that HOHQMesh will give to this boundary curve in the resulting mesh file.</p><p>The new <code>circ</code> curve is then added to the <code>spline_project</code> as an outer boundary curve with</p><pre><code class="language-julia hljs">addCurveToOuterBoundary!(spline_project, circ)</code></pre><h2 id="Add-a-background-grid"><a class="docs-heading-anchor" href="#Add-a-background-grid">Add a background grid</a><a id="Add-a-background-grid-1"></a><a class="docs-heading-anchor-permalink" href="#Add-a-background-grid" title="Permalink"></a></h2><p>HOHQMesh requires a background grid for the mesh generation process. This background grid sets the base resolution of the desired mesh. HOHQMesh will automatically subdivide from this background grid near sharp features of any curved boundaries.</p><p>For a domain bounded by an outer boundary curve, this background grid is set by indicating the desired element size in the <span>$x$</span> and <span>$y$</span> directions. To start, we set the background grid for <code>spline_project</code> to have elements with side length <span>$0.6$</span> in each direction</p><pre><code class="language-julia hljs">addBackgroundGrid!(spline_project, [0.6, 0.6, 0.0])</code></pre><p>We next visualize the outer boundary curve and background grid with the following</p><pre><code class="language-julia hljs">plotProject!(spline_project, MODEL+GRID)</code></pre><p>Here, we take the sum of the keywords <code>MODEL</code> and <code>GRID</code> in order to simultaneously visualize the outer boundary and background grid. The resulting plot is given below. The chain of outer boundary curves is called <code>&quot;Outer&quot;</code> and it contains a single curve <code>&quot;outerCircle&quot;</code> labeled in the figure by <code>O.1</code>.</p><p><img src="https://user-images.githubusercontent.com/25242486/174798948-3a00c5b5-d910-45df-9a9a-088eb3fa360a.png" alt="background_grid"/></p><h2 id="Add-the-inner-boundaries"><a class="docs-heading-anchor" href="#Add-the-inner-boundaries">Add the inner boundaries</a><a id="Add-the-inner-boundaries-1"></a><a class="docs-heading-anchor-permalink" href="#Add-the-inner-boundaries" title="Permalink"></a></h2><p>The domain of this tutorial will contain three inner boundary curves:</p><ol><li>Cubic spline curve created from data points read in from a file.</li><li>Cubic spline curve created from points directly given in the code.</li><li>Triangular shape built from three straight line &quot;curves&quot;.</li></ol><h3 id="Cubic-spline-with-data-from-a-file"><a class="docs-heading-anchor" href="#Cubic-spline-with-data-from-a-file">Cubic spline with data from a file</a><a id="Cubic-spline-with-data-from-a-file-1"></a><a class="docs-heading-anchor-permalink" href="#Cubic-spline-with-data-from-a-file" title="Permalink"></a></h3><p>A parametric cubic spline curve can be constructed from a file of data points. The first line of this plain text file must indicate the number of nodes. Then line-by-line the file contains the knots <span>$t_j$</span>, <span>$x_j$</span>, <span>$y_j$</span>, <span>$z_j$</span> where <span>$j$</span> indexes the number of nodes. If the spline curve is to be closed. The last data point must be the same as the first. For examples, see the <a href="https://trixi-framework.github.io/HOHQMesh/the-model/#the-spline-curve-definition">HOHQMesh documentation</a> or open the file <code>test_spline_curve_data.txt</code> in the <a href="https://github.com/trixi-framework/HOHQMesh.jl/tree/main/examples">examples</a> folder</p><p>We create a parametric spline curve from a file with</p><pre><code class="language-julia hljs">spline1 = newSplineCurve(&quot;big_spline&quot;, joinpath(@__DIR__, &quot;examples&quot;, &quot;test_spline_curve_data.txt&quot;))</code></pre><p>The name of the curve stored in the dictionary <code>spline1</code> is assigned to be <code>&quot;big_spline&quot;</code>. This curve name is also the label that HOHQMesh will give to this boundary curve in the resulting mesh file.</p><p>The new <code>spline1</code> curve is then added to the <code>spline_project</code> as an inner boundary curve with</p><pre><code class="language-julia hljs">addCurveToInnerBoundary!(spline_project, spline1, &quot;inner1&quot;)</code></pre><p>This inner boundary chain name <code>&quot;inner1&quot;</code> is used internally by HOHQMesh. The visualization of the background grid automatically detects that a curve has been added to the project and the plot is updated appropriately, as shown below. The chain for the inner boundary curve is called <code>inner1</code> and it contains a single curve <code>&quot;big_spline&quot;</code> labeled in the figure by <code>1.1</code>.</p><p><img src="https://user-images.githubusercontent.com/25242486/174798958-5e4a57b3-ece0-4d11-a004-b39909fccbad.png" alt="one_curve"/></p><h3 id="Cubic-spline-from-data-in-Julia"><a class="docs-heading-anchor" href="#Cubic-spline-from-data-in-Julia">Cubic spline from data in Julia</a><a id="Cubic-spline-from-data-in-Julia-1"></a><a class="docs-heading-anchor-permalink" href="#Cubic-spline-from-data-in-Julia" title="Permalink"></a></h3><p>Alternatively, a parametric cubic spline curve can be constructed directly from data points provided in the code. These points take the form <code>[t, x, y, z]</code> where <code>t</code> is the parameter variable that varies between <span>$0$</span> and <span>$1$</span>. For the spline construction, the number of points is included as an input argument as well as the actual parametric point data. Again, if the spline curve is to be closed, the first and last data point <strong>must</strong> match.</p><p>Below, we construct another parametric spline using this strategy that consists of five data points</p><pre><code class="language-julia hljs">spline_data = [ [0.0  1.75 -1.0 0.0]
                [0.25 2.1  -0.5 0.0]
                [0.5  2.7  -1.0 0.0]
                [0.75 0.6  -2.0 0.0]
                [1.0  1.75 -1.0 0.0] ]

spline2 = newSplineCurve(&quot;small_spline&quot;, 5, spline_data)</code></pre><p>The name of the curve stored in the dictionary <code>spline2</code> is assigned to be <code>&quot;small_spline&quot;</code>. This curve name is also the label that HOHQMesh will give to this boundary curve in the resulting mesh file.</p><p>The new <code>spline2</code> curve is then added to the <code>spline_project</code> as an inner boundary curve with</p><pre><code class="language-julia hljs">addCurveToInnerBoundary!(spline_project, spline2, &quot;inner2&quot;)</code></pre><p>This inner boundary chain name <code>&quot;inner2&quot;</code> is used internally by HOHQMesh. The visualization of the background grid automatically detects that a curve has been added to the project and the plot is updated appropriately, as shown below. The chain for the inner boundary curve is called <code>inner2</code> and it contains a single curve <code>&quot;small_spline&quot;</code> labeled in the figure by <code>2.1</code>.</p><p><img src="https://user-images.githubusercontent.com/25242486/174798962-99e0673d-e0f9-444a-a71d-7dfd9412306e.png" alt="two_curves"/></p><h3 id="Triangular-shape"><a class="docs-heading-anchor" href="#Triangular-shape">Triangular shape</a><a id="Triangular-shape-1"></a><a class="docs-heading-anchor-permalink" href="#Triangular-shape" title="Permalink"></a></h3><p>Finally, we build a triangular shaped inner boundary curve built from a chain of three straight lines. Each line segment is defined using the function <code>newEndPointsLineCurve</code>. We construct the three line segments that define the edges of a triangular shape with</p><pre><code class="language-julia hljs">edge1 = newEndPointsLineCurve(&quot;triangle&quot;,        # curve name
                              [-2.3, -1.0, 0.0], # start point
                              [-1.7, -1.0, 0.0]) # end point

edge2 = newEndPointsLineCurve(&quot;triangle&quot;,        # curve name
                              [-1.7, -1.0, 0.0], # start point
                              [-2.0, -0.4, 0.0]) # end point

edge3 = newEndPointsLineCurve(&quot;triangle&quot;,        # curve name
                              [-2.0, -0.4, 0.0], # start point
                              [-2.3, -1.0, 0.0]) # end point</code></pre><p>Here, each edge of the curve is given the same name <code>&quot;triangle&quot;</code> as this curve name is also the label that HOHQMesh will give to this boundary curve in the resulting mesh file.</p><p>The three line segments <code>edge1</code>, <code>edge2</code>, and <code>edge3</code> are connected in a counter-clockwise orientation as required by HOHQMesh.</p><pre><code class="language-julia hljs">addCurveToInnerBoundary!(spline_project, edge1, &quot;inner3&quot;)
addCurveToInnerBoundary!(spline_project, edge2, &quot;inner3&quot;)
addCurveToInnerBoundary!(spline_project, edge3, &quot;inner3&quot;)</code></pre><p>The inner boundary chain name <code>&quot;inner3&quot;</code> is used internally for HOHQMesh. Again, the active visualization automatically detects that new curves have been added to the project and the plot is updated appropriately, as shown below. The chain for the inner triangular boundary is called <code>inner3</code> and it contains a three curve segments all called <code>&quot;triangle&quot;</code> labeled in the figure by <code>3.1</code>, <code>3.2</code>, and <code>3.3</code>.</p><p><img src="https://user-images.githubusercontent.com/25242486/174798968-d41d7d8e-db1e-466f-a4fa-c36f14dfae98.png" alt="three_curves"/></p><h2 id="Generate-the-mesh"><a class="docs-heading-anchor" href="#Generate-the-mesh">Generate the mesh</a><a id="Generate-the-mesh-1"></a><a class="docs-heading-anchor-permalink" href="#Generate-the-mesh" title="Permalink"></a></h2><p>With the background grid, outer boundary curve, and all inner boundary curves added to the <code>spline_project</code> we are ready to generate the mesh. This will output the following files to the <code>out</code> folder:</p><ul><li><code>spline_curves.control</code>: A HOHQMesh control file for the current project.</li><li><code>spline_curves.tec</code>: A TecPlot formatted file to visualize the mesh with other software, e.g., <a href="https://www.paraview.org/">ParaView</a>.</li><li><code>spline_curves.mesh</code>: A mesh file with format <code>ISM-V2</code> (the default format).</li></ul><p>To do this we execute the command</p><pre><code class="language-julia hljs">generate_mesh(spline_project)
           1  chevron elements removed from mesh.
           1  chevron elements removed from mesh.

 *******************
 2D Mesh Statistics:
 *******************
    Total time             =   0.29613000000000000
    Number of nodes        =         1177
    Number of Edges        =         2225
    Number of Elements     =         1047
    Number of Subdivisions =            4

 Mesh Quality:
         Measure         Minimum         Maximum         Average  Acceptable Low Acceptable High       Reference
     Signed Area      0.00006214      0.15607014      0.04505181      0.00000000    999.99900000      1.00000000
    Aspect Ratio      1.00008989      2.78073390      1.23192911      1.00000000    999.99900000      1.00000000
       Condition      1.00000055      3.81350981      1.15526066      1.00000000      4.00000000      1.00000000
      Edge Ratio      1.00014319      6.76310951      1.46264239      1.00000000      4.00000000      1.00000000
        Jacobian      0.00001495      0.10424741      0.03955903      0.00000000    999.99900000      1.00000000
   Minimum Angle     37.25504203     89.96195708     74.41060580     40.00000000     90.00000000     90.00000000
   Maximum Angle     90.03105286    157.27881545    107.90994073     90.00000000    135.00000000     90.00000000
       Area Sign      1.00000000      1.00000000      1.00000000      1.00000000      1.00000000      1.00000000</code></pre><p>The call to <code>generate_mesh</code> also prints mesh quality statistics to the screen. HOHQMesh also reports mesh clean-up that occurred during the generation process, in this case the removal of &quot;bad&quot; chevron shaped elements that were present within the automatic subdivision procedure. The visualization updates automatically and the background grid is <em>removed</em> after when the mesh is generated.</p><div class="admonition is-info"><header class="admonition-header">Mesh visualization</header><div class="admonition-body"><p>Currently, only the &quot;skeleton&quot; of the mesh is visualized. Thus, the high-order curved boundary information is not seen in the plot but this information <strong>is present</strong> in the generated mesh file.</p></div></div><p><img src="https://user-images.githubusercontent.com/25242486/174798986-6b900fa8-840c-4c04-bc61-00f0749af1be.png" alt="final_spline"/></p><p>Inspecting the mesh we see that the automatic subdivision in HOHQMesh does well to capture the fine features of the curved inner boundaries, particularly near the sharp angles of the <code>&quot;big_spline&quot;</code> curve. We decide that we are satisfied with the overall mesh quality.</p><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>In this tutorial we demonstrated how to:</p><ul><li>Create a circular outer boundary curve.</li><li>Add the background grid when an outer boundary curve is present.</li><li>Visualize an interactive mesh project.</li><li>Construct and add parametric spline curves.</li><li>Construct and add an inner boundary chain of straight line segments.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../curved_outer_boundary/">« Curved outer boundary</a><a class="docs-footer-nextpage" href="../create_edit_curves/">Creating and editing curves »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Friday 24 June 2022 10:48">Friday 24 June 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
